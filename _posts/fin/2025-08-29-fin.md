---
layout: post
title: 金融学投资组合 投资组合优化的约束条件
date:  2025-08-29 09:01:00 +0800
image: 08.jpg
tags: 
    - python
    - financial
    - fintech
---

在马科维茨的理想化世界里，我们可以任意分配权重（甚至允许做空、无限杠杆）。
但在现实市场中，投资组合优化往往需要加入**约束条件**。

---

## 📌 1. 常见的权重约束

1. **预算约束（Budget Constraint）**

   * 总投资金额必须为 100%（或 1）：

   $$
   \sum_{i=1}^n w_i = 1
   $$

2. **非负约束（No Short-Selling Constraint）**

   * 不允许做空：

   $$
   w_i \geq 0, \quad \forall i
   $$

3. **杠杆约束（Leverage Constraint）**

   * 限制杠杆倍数，例如：

   $$
   \sum |w_i| \leq 1.2
   $$

   表示最多允许 20% 杠杆。

4. **单资产上限（Concentration Constraint）**

   * 防止过度集中：

   $$
   w_i \leq 0.1, \quad \forall i
   $$

   每个资产最多 10%。

5. **行业 / 风格约束（Sector Constraint）**

   * 例如科技股不超过 40%。

6. **交易成本约束（Transaction Cost Constraint）**

   * 权重变化过大时，会增加摩擦成本，因此约束：

   $$
   |w_i^{new} - w_i^{old}| \leq \delta
   $$

---

## 📌 2. 数学建模

优化问题可以写成：

$$
\min_w \quad w^T \Sigma w
$$

约束条件：

$$
\begin{cases} 
\sum w_i = 1 \\
w_i \geq 0 \quad (\text{如不允许做空}) \\
w_i \leq u_i \quad (\text{集中度上限})
\end{cases}
$$

---

## 📌 3. Python 示例：带约束的最小方差组合

这里我们用 `scipy.optimize` 来求解：

```python
import numpy as np
import pandas as pd
from scipy.optimize import minimize

# 假设协方差矩阵
cov_matrix = np.array([[0.04, 0.02, 0.01],
                       [0.02, 0.05, 0.03],
                       [0.01, 0.03, 0.06]])

n_assets = cov_matrix.shape[0]

# 风险函数（组合方差）
def portfolio_volatility(weights, cov_matrix):
    return np.sqrt(weights.T @ cov_matrix @ weights)

# 约束条件
constraints = [
    {'type': 'eq', 'fun': lambda w: np.sum(w) - 1},    # 权重和 = 1
]
bounds = [(0, 0.6) for _ in range(n_assets)]  # 每个资产权重 0% ~ 60%

# 初始猜测
init_guess = np.ones(n_assets) / n_assets

# 优化
result = minimize(portfolio_volatility,
                  init_guess,
                  args=(cov_matrix,),
                  method='SLSQP',
                  bounds=bounds,
                  constraints=constraints)

print("最优权重:", result.x)
print("组合风险:", result.fun)
```

👉 上例说明：

* 每个资产权重在 `[0, 0.6]` 之间
* 总和必须 = 1
* 得到的是**带约束的最小方差组合**

---

## 📌 4. 实际应用

* **基金经理**：通常不能无限做空，权重要受监管和基金契约限制。
* **ETF 产品**：要满足指数跟踪误差约束。
* **保险、养老金**：可能要求固定比例投资于债券或现金。
* **对冲基金**：常有杠杆和空头仓位，但仍然有风险限制。

---

✅ **小结：**

* 理论模型是“无限制优化”，现实中必须引入 **权重约束**。
* 约束可能降低最优解的“效率”，但会提高**可执行性和稳健性**。