---
layout: post
title:  python网络爬虫实战-playwright
date:   2025-08-07 09:01:00 +0800
tags: 
    - python
    - web
image: 02.jpg
---

大家好，我是python网络爬虫这门课程的主要讲师geo

`playwright`比`selenium`强大

Playwright 是由 **微软 (Microsoft)** 开发的一个 **自动化测试框架**，主要用于 **Web UI 自动化**。
它的目标是帮助开发者和测试人员编写可靠的端到端（end-to-end, E2E）测试脚本。

它支持：

* **多浏览器**：Chromium（Chrome, Edge）、Firefox、WebKit（Safari）。
* **多语言**：Python、JavaScript/TypeScript、Java、.NET。
* **跨平台**：Windows、Linux、macOS。

---

### 核心功能

* **自动浏览器操作**：像人类一样点击按钮、填写表单、滚动页面、上传文件。
* **无头模式 (headless)**：可以在后台运行，不需要打开实际浏览器窗口。
* **多浏览器上下文 (BrowserContext)**：在同一个浏览器里开多个“独立会话”，适合测试不同用户登录状态。
* **等待机制 (auto-wait)**：自动等待元素出现或页面加载完成，不容易出“元素未找到”的错误。
* **跨设备测试**：模拟手机、平板等设备（分辨率、触控）。
* **截图和视频录制**：方便调试和生成测试报告。

| 特性       | Playwright                | Selenium  |
| -------- | ------------------------- | --------- |
| 浏览器支持    | Chromium, Firefox, WebKit | 几乎所有主流浏览器 |
| 等待机制     | 自动等待，稳定性高                 | 需要手动加显式等待 |
| API 设计   | 现代化，链式调用方便                | 相对传统      |
| 多标签/多上下文 | 内置支持                      | 需要额外处理    |
| 语言支持     | JS/TS, Python, Java, .NET | 多种语言      |
| 速度       | 通常更快                      | 稍慢        |

怎么开始?

```bash
pip install playwright
playwright install
```

如果执行不了`playwright install`则执行

```bash
python -m playwright install
```

要安装 Firefox 内核

```bash
playwright install firefox
```

### 示例 打开网页并提取标题

chromium 

```py
from playwright.sync_api import sync_playwright

with sync_playwright() as p:
    browser = p.chromium.launch(headless=True)  # 设置 headless=False 可看到界面
    page = browser.new_page()
    page.goto("https://example.com")
    print("网页标题是：", page.title())
    browser.close()
```

firefox

```py
from playwright.sync_api import sync_playwright

with sync_playwright() as p:
    # 启动 Firefox
    browser = p.firefox.launch(headless=True)  # headless=True 表示无头模式
    page = browser.new_page()
    # 打开网页
    page.goto("https://www.wikipedia.org")
    # 输入搜索关键字并提交
    page.fill("input[name='search']", "Playwright")
    page.press("input[name='search']", "Enter")
    # 等待页面加载完成
    page.wait_for_load_state("networkidle")
    print("网页标题:", page.title())
    browser.close()
```

### 自动化工具

```
python3 -m  playwright codegen "google.com"
```

<!-- ### 示例 抓取动态加载的内容（知乎热门话题）

```py
from playwright.sync_api import sync_playwright

with sync_playwright() as p:
    browser = p.chromium.launch(headless=True)
    page = browser.new_page()
    page.goto("https://www.zhihu.com/hot", timeout=60000)
    page.wait_for_timeout(3000)  # 等待页面渲染

    titles = page.query_selector_all('section h2')
    for idx, title in enumerate(titles, 1):
        print(f"{idx}. {title.text_content()}")

    browser.close()
```

### 示例 抓取京东商品名称与价格（需翻页）

```py
from playwright.sync_api import sync_playwright

with sync_playwright() as p:
    browser = p.chromium.launch(headless=True)
    page = browser.new_page()
    page.goto('https://search.jd.com/Search?keyword=耳机', timeout=60000)
    page.wait_for_selector('.gl-item')

    items = page.query_selector_all('.gl-item')
    for item in items[:10]:
        name = item.query_selector('.p-name em').text_content().strip()
        price = item.query_selector('.p-price i').text_content().strip()
        print(f"{name} - ¥{price}")

    browser.close()
``` -->